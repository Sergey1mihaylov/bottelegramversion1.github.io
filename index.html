<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Платежный календарь</title>
<script src="https://telegram.org/js/telegram-web-app.js"></script>
<link rel="stylesheet" href="styles.css">
</head>
<body>

<div id="app">
  <h1>Платёжный календарь</h1>
  <button id="add-payment">Добавить платеж</button>

  <div id="payments"></div>
</div>

<script type="module">
  import { loadData, saveData } from "./storage.js";
  import { getTelegramUserId } from "./bot.js";

  const userId = getTelegramUserId();

  async function init() {
      const data = await loadData();
      render(data);
  }

  function render(data) {
      const box = document.getElementById("payments");
      box.innerHTML = data.payments.length
          ? data.payments.map(p => `<div>${p.name} — ${p.amount}</div>`).join("")
          : "<div>Платежей пока нет</div>";
  }

  document.getElementById("add-payment").onclick = async () => {
      const data = await loadData();
      data.payments.push({
          id: Date.now(),
          name: "Новый платеж",
          amount: 1000
      });
      await saveData(data);
      init();
  };

  init();
</script>

</body>
</html>
